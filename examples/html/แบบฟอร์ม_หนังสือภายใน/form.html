<!DOCTYPE html >

<html>

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"
    />

    <title>E-form</title>
    

    <script
      src="./ระบบสารบรรณอิเล็กทรอนิกส์ ซิตี้วาไรตี้_files/jquery-1.9.1.min.js"
      type="text/javascript"
    ></script>
    <script
      src="./ระบบสารบรรณอิเล็กทรอนิกส์ ซิตี้วาไรตี้_files/jquery-migrate-1.2.1.min.js"
      type="text/javascript"
    ></script>

    <link
      rel="stylesheet"
      href="./ระบบสารบรรณอิเล็กทรอนิกส์ ซิตี้วาไรตี้_files/jquery-ui.custom.min.css"
      type="text/css"
    />
    <script
      src="./ระบบสารบรรณอิเล็กทรอนิกส์ ซิตี้วาไรตี้_files/jquery-ui-1.10.1.custom.min.js"
      type="text/javascript"
    ></script>
    <script
      src="./ระบบสารบรรณอิเล็กทรอนิกส์ ซิตี้วาไรตี้_files/jquery.validate.js"
      type="text/javascript"
    ></script>

    <link
      href="./ระบบสารบรรณอิเล็กทรอนิกส์ ซิตี้วาไรตี้_files/register1.css"
      rel="stylesheet"
      type="text/css"
    />

    <link
      href="./ระบบสารบรรณอิเล็กทรอนิกส์ ซิตี้วาไรตี้_files/pagesize.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="./ระบบสารบรรณอิเล็กทรอนิกส์ ซิตี้วาไรตี้_files/form-5-sign.css"
      rel="stylesheet"
      type="text/css"
    />

    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="../../editor/summernote.css" rel="stylesheet" />
    <style>



            page {
              box-shadow: 0 0 0.5cm rgb(0 0 0 / 50%);
            }
.mainBlock {
        display: flex !important;
      }


      .bookHome .bottom {
        background: #3fc5e0 !important;
      }

      .bookHome .top {
        background: #3fc5e0 !important;
      }
      .bookHome .left {
        background: #438eff !important;
      }
      .bookHome .mid {
        background: #fff !important;
      }
    </style>
  </head>

  <body cz-shortcut-listen="true">

    <div class="bookHome">
      <div class="mid">
        <div class="m-in mainBlock" style="padding-top: 0px !important">


            <form
              name="create_order"
              method="post"
              id="create_order"
              action="./pdf.php"
            >

              <span id="block_tab_1" style="display: inline">
                <page
                  size="A4"
                  id="page1"
                >
                  <div class="form-5">
                    <table
                      width="100%"
                      border="0"
                      cellspacing="0"
                      cellpadding="0"
                    >
                      <tbody>
                        <tr>
                          <td align="left" valign="top">
                            <table
                              width="100%"
                              border="0"
                              cellspacing="0"
                              cellpadding="0"
                            >
                              <tbody>
                                <tr>
                                  <td width="30%" align="left" valign="top">
                                    <img
                                      src="./ระบบสารบรรณอิเล็กทรอนิกส์ ซิตี้วาไรตี้_files/krut.png"
                                    />
                                  </td>
                                  <td
                                    width="40%"
                                    align="left"
                                    valign="top"
                                    style=""
                                  >
                                    <table
                                      width="100%"
                                      border="0"
                                      cellspacing="0"
                                      cellpadding="0"
                                    >
                                      <tbody>
                                        <tr>
                                          <td align="center" valign="top">
                                            <div class="form-text">
                                              บันทึกข้อความ
                                            </div>
                                          </td>
                                        </tr>
                                      </tbody>
                                    </table>
                                  </td>
                                  <td width="30%" align="center" valign="top">
                                    &nbsp;
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </td>
                        </tr>
                        <tr>
                          <td align="left" valign="top">
                            <table
                              width="100%"
                              border="0"
                              cellspacing="0"
                              cellpadding="0"
                            >
                              <tbody>
                                <tr>
                                  <td align="left" valign="top" class="p-8">
                                    <table
                                      width="100%"
                                      border="0"
                                      cellspacing="0"
                                      cellpadding="0"
                                    >
                                      <tbody>
                                        <tr>
                                          <td align="left" valign="bottom">
                                            <table
                                              width="100%"
                                              border="0"
                                              cellspacing="0"
                                              cellpadding="0"
                                            >
                                              <tbody>
                                                <tr>
                                                  <td
                                                    width="15%"
                                                    align="left"
                                                    valign="bottom"
                                                  >
                                                    <div class="letter-head-2">
                                                      ส่วนราชการ
                                                    </div>
                                                  </td>
                                                  <td
                                                    width="85%"
                                                    align="left"
                                                    valign="bottom"
                                                    class="border-bottom-2"
                                                  >
                                                    <input
                                                      type="text"
                                                      class="required box-input error"
                                                      name="government"
                                                      value=""
                                                      onblur="changeThaiNumberFormat(this)"
                                                      autocomplete="off"
                                                    /><label
                                                      for="government"
                                                      generated="true"
                                                      class="error"
                                                      ><div style="color: #f00">
                                                        กรุณากรอกข้อมูลให้ครบถ้วน
                                                      </div></label
                                                    >
                                                  </td>
                                                </tr>
                                              </tbody>
                                            </table>
                                          </td>
                                        </tr>
                                      </tbody>
                                    </table>
                                  </td>
                                </tr>
                                <tr>
                                  <td align="left" valign="top" class="p-8">
                                    <table
                                      width="100%"
                                      border="0"
                                      cellspacing="0"
                                      cellpadding="0"
                                    >
                                      <tbody>
                                        <tr>
                                          <td align="left" valign="bottom">
                                            <table
                                              width="100%"
                                              border="0"
                                              cellspacing="0"
                                              cellpadding="0"
                                            >
                                              <tbody>
                                                <tr>
                                                  <td
                                                    width="2%"
                                                    align="left"
                                                    valign="bottom"
                                                  >
                                                    <div class="letter-head-2">
                                                      ที่
                                                    </div>
                                                  </td>
                                                  <td
                                                    width="47%"
                                                    align="center"
                                                    valign="bottom"
                                                    class="border-bottom-2"
                                                  >
                                                    อัตโนมัติ
                                                  </td>
                                                  <td
                                                    width="6%"
                                                    align="center"
                                                    valign="bottom"
                                                  >
                                                    <div class="letter-head-2">
                                                      วันที่
                                                    </div>
                                                  </td>
                                                  <td
                                                    width="45%"
                                                    align="center"
                                                    valign="bottom"
                                                    class="border-bottom-2"
                                                    style="padding-left: 20px"
                                                  >
                                                    อัตโนมัติ
                                                  </td>
                                                </tr>
                                              </tbody>
                                            </table>
                                          </td>
                                        </tr>
                                      </tbody>
                                    </table>
                                  </td>
                                </tr>
                                <tr>
                                  <td align="left" valign="top" class="p-8">
                                    <table
                                      width="100%"
                                      border="0"
                                      cellspacing="0"
                                      cellpadding="0"
                                    >
                                      <tbody>
                                        <tr>
                                          <td align="left" valign="bottom">
                                            <table
                                              width="100%"
                                              border="0"
                                              cellspacing="0"
                                              cellpadding="0"
                                            >
                                              <tbody>
                                                <tr>
                                                  <td
                                                    width="8%"
                                                    align="left"
                                                    valign="bottom"
                                                    class="letter-head-2"
                                                  >
                                                    เรื่อง
                                                  </td>
                                                  <td
                                                    width="92%"
                                                    align="left"
                                                    valign="bottom"
                                                    class="border-bottom-2"
                                                  >
                                                    <input
                                                      type="text"
                                                      class="box-input required"
                                                      name="subject"
                                                      value=""
                                                      autocomplete="off"
                                                      onblur="changeThaiNumberFormat(this)"
                                                    />
                                                  </td>
                                                </tr>
                                              </tbody>
                                            </table>
                                          </td>
                                        </tr>
                                      </tbody>
                                    </table>
                                  </td>
                                </tr>
                                <tr>
                                  <td align="left" valign="top" class="p-8">
                                    <table
                                      width="100%"
                                      border="0"
                                      cellspacing="0"
                                      cellpadding="0"
                                    >
                                      <tbody>
                                        <tr>
                                          <td align="left" valign="bottom">
                                            <table
                                              width="100%"
                                              border="0"
                                              cellspacing="0"
                                              cellpadding="0"
                                            >
                                              <tbody>
                                                <tr>
                                                  <td
                                                    width="8%"
                                                    align="left"
                                                    valign="bottom"
                                                    class="letter-head-2"
                                                    style="font-size: 16pt"
                                                  >
                                                    เรียน
                                                  </td>
                                                  <td
                                                    width="92%"
                                                    align="left"
                                                    valign="bottom"
                                                    class="border-bottom-2"
                                                    style="border: none"
                                                  >
                                                    <input
                                                      type="text"
                                                      class="box-input"
                                                      name="order_save_to"
                                                      value=""
                                                      autocomplete="off"
                                                    />
                                                  </td>
                                                </tr>
                                              </tbody>
                                            </table>
                                          </td>
                                        </tr>
                                      </tbody>
                                    </table>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </td>
                        </tr>
                      </tbody>
                    </table>

                    <span class="block_description"> </span>

                    <div class="form-group row mt-5" >
                      <div class="col-lg-12">
                        <a class="ring-1 ring-slate-900/5 space-y-3 hover:bg-sky-500 hover:ring-sky-500" href="javascript:;" onclick="addTopic(1);"
                          ><strong>+ เพิ่มหัวข้อใหม่</strong></a
                        >
                        <a class="ring-1 ring-slate-900/5 space-y-3 hover:bg-sky-500 hover:ring-sky-500" href="javascript:;" onclick="addParagraph(1);"
                          ><strong>+ เพิ่มย่อหน้าใหม่</strong></a
                        >
                      </div>
                    </div>
                  </div>

                  <div class="footerText">
                    <textarea
                      autocomplete="off"
                      name="footerText[0]"
                      onblur="changeThaiNumberFormat(this)"
                      style="height: 48px"
                    ></textarea>
                  </div>
                
                </page>
                <div
                  class="form-group row"
                  style="
                    line-height: 30px;
                    line-height: 30px;
                    text-align: center;
                    padding-top: 32px;
                    padding-bottom: 32px;
                  "
                  id="addPage"
                >
                  <div class="col-lg-12">
                    <a href="javascript:;" onclick="addPage();"
                      ><strong>+ เพิ่มหน้าใหม่</strong></a
                    >
                  </div>
                </div>
              </span>

  
      


              </span>

  
            </form>
          </div>
          <script>
            $(function () {
              $("#create_order").validate();
            });

          </script>

          <span style="display: none">
            <span id="block_clone">
              <div class="box-textarea">
                <a
                  href="javascript:;"
                  class="btn btn-danger btn-remove py-2"
                  onclick="$(this).parent().remove();"
                  >X</a
                >
                <textarea
                  oninput="auto_grow(this)"
                  type="text"
                  autocomplete="off"
                  name="description[{i}][]"
                  onblur="changeThaiNumberFormat(this)"
                  rows="50"
                  class="my-1 block w-full py-2 bg-white border border-slate-300  text-sm shadow-sm placeholder-slate-400"
                ></textarea>
              </div>
            </span>
            <span id="block_clone_topic">
              <div class="box-textarea">
                <a
                  href="javascript:;"
                  class="btn btn-danger btn-remove py-2"
                  onclick="$(this).parent().remove();"
                  >X</a
                >
                <input
                  type="text"
                  class="my-1 block w-full  py-2 bg-white border border-slate-300  text-sm shadow-sm placeholder-slate-400"
                  name="description[{i}][]"
                  onblur="changeThaiNumberFormat(this)"
                  autocomplete="off"
                />
              </div>
            </span>
          </span>
        </div>
      </div>
 
    </div>
    <script type="text/javascript">
      function addParagraph(page) {
        var i = page - 1;
        console.log(i);
        var blockClone = $("#block_clone").html();
        var tmp = blockClone.replaceAll("{i}", i).trim();
        $("#page" + page + " .block_description").append(tmp);
      }

      function addTopic(page) {
        var i = page - 1;
        console.log(i);
        var blockClone = $("#block_clone_topic").html();
        var tmp = blockClone.replaceAll("{i}", i).trim();
        $("#block_tab_1 #page" + page + " .block_description").append(
          tmp
        );
      }

      function addPage() {
        var tmp_page = $("#block_tab_1 page").length;
        var page = $("#block_tab_1 page").length + 1;
        var thaiPage = changeThaiNumber(page);

        var html =
          '<page size="A4" id="page' +
          page +
          '">' +
          ' <div class="nextPage">-' +
          thaiPage +
          "-</div>" +
          '<a href="javascript:;" class="btn btn-danger btn-remove" onclick="$(this).parent().remove();">X</a><div class="form-group row " style="line-height: 30px;"><div class="col-lg-12">' +
          '<div class="form-5"><span class="block_description"></span>' +
          '    <a href="javascript:;" onclick="addTopic(' +
          page +
          ');"><strong>+ เพิ่มหัวข้อใหม่</strong></a><a href="javascript:;" onclick="addParagraph(' +
          page +
          ');"><strong>+ เพิ่มย่อหน้าใหม่</strong></a>' +
          "</div>" +
          "</div></div>" +
          '<div class="footerText"><textarea autocomplete="off" name="footerText[' +
          tmp_page +
          ']" onblur="changeThaiNumberFormat(this)"></textarea></div>' +
          '<div class="footerImg"><img src="images/logo_footer.png" /></div>' +
          "</page>";
        $("#block_tab_1 #addPage").before(html);
      }

      function auto_grow(element) {
        element.style.height = "5px";
        element.style.height = element.scrollHeight + "px";
      }

      function textareaAllHeight() {
        $("textarea").each(function (index) {
          auto_grow(this);
        });
      }

  

      $(function () {
        setTimeout(function () {
          textareaAllHeight();
        }, 1000);
      });
    </script>
    



    <script>
      function createForm(id) {
        console.log(id);
        var controller = "";
        if (id == 15) {
          controller = "order_save";
        } else if (id == 2) {
          controller = "order";
        } else if (id == 4) {
          controller = "order_command";
        } else if (id == 5) {
          controller = "order_publish";
        } else if (id == 9) {
          controller = "order_seal";
        } else if (id == 3) {
          controller = "order_secret";
        } else if (id == 16) {
          controller = "order_project";
        } else if (id == 152) {
          controller = "order_local";
        } else if (id == 162) {
          controller = "order_volunteer";
        }

        var url = "https://saraban.demo-cv.com/" + controller + "/createForm";
        console.log(url);
        var data = {};
        $.post(url, data, function (rs) {
          //console.log(rs);
          $(".m-in").html(rs);
          $(".m-in").attr("style", "padding-top: 0px !important;");
        });
      }

      function editForm(id, order_id) {
        var controller = "";
        if (id == 15) {
          controller = "order_save";
        } else if (id == 2) {
          controller = "order";
        } else if (id == 4) {
          controller = "order_command";
        } else if (id == 5) {
          controller = "order_publish";
        } else if (id == 9) {
          controller = "order_seal";
        } else if (id == 3) {
          controller = "order_secret";
        } else if (id == 16) {
          controller = "order_project";
        } else if (id == 152) {
          controller = "order_local";
        } else if (id == 162) {
          controller = "order_volunteer";
        }

        var url = "https://saraban.demo-cv.com/" + controller + "/editForm";
        var data = {
          order_id: order_id,
        };
        $.post(url, data, function (rs) {
          $(".m-in").html(rs);
          $(".m-in").attr("style", "padding-top: 0px !important;");
        });
      }

      function pdfSignFrom(id) {
        var controller = "";
        if (id == 15) {
          controller = "order_save";
        } else if (id == 2) {
          controller = "order";
        } else if (id == 4) {
          controller = "order_command";
        } else if (id == 5) {
          controller = "order_publish";
        } else if (id == 9) {
          controller = "order_seal";
        } else if (id == 1) {
          controller = "order_receiver_get";
        } else if (id == 3) {
          controller = "order_secret";
        } else if (id == 16) {
          controller = "order_project";
        } else if (id == 152) {
          controller = "order_local";
        } else if (id == 162) {
          controller = "order_volunteer";
        }

        var url = "https://saraban.demo-cv.com/" + controller + "/pdfSignFrom";
        var data = {};
        $.post(url, data, function (rs) {
          $(".m-in").html(rs);
          $(".m-in").attr("style", "padding-top: 0px !important;");
        });
      }

      function pdfSignEditForm(id, order_id) {
        var controller = "";
        if (id == 15) {
          controller = "order_save";
        } else if (id == 2) {
          controller = "order";
        } else if (id == 4) {
          controller = "order_command";
        } else if (id == 5) {
          controller = "order_publish";
        } else if (id == 9) {
          controller = "order_seal";
        } else if (id == 1) {
          controller = "order_receiver_get";
        } else if (id == 3) {
          controller = "order_secret";
        } else if (id == 16) {
          controller = "order_project";
        } else if (id == 152) {
          controller = "order_local";
        } else if (id == 162) {
          controller = "order_volunteer";
        }

        var url =
          "https://saraban.demo-cv.com/" + controller + "/pdfSignEditForm";
        var data = {
          order_id: order_id,
        };
        $.post(url, data, function (rs) {
          $(".m-in").html(rs);
          $(".m-in").attr("style", "padding-top: 0px !important;");
        });
      }

      ///////////////FROM
      function getFrom(tag) {
        var url = "https://saraban.demo-cv.com/allpage/getFrom";
        var data = {
          tag: tag,
          order_id: "",
          cmd: "",
        };
        $.post(url, data, function (rs) {
          $(".m-in").html(rs);
          $(".m-in").attr("style", "padding-top: 0px !important;");
        });
      }

      /////////////
      function toThaiStringNoPreg(obj) {
        var str = $(obj).val();

        var val = {
          order_num: str,
        };
        if (str != "" || str != null) {
          var url = "https://saraban.demo-cv.com/order/changeToThaiOrderShow";
          console.log(url);
          $.post(url, val, function (data) {
            console.log(data);
            $(obj).val(data);
          });
        }
      }

      function changeThaiNumberFormat(obj) {
        var str = $(obj).val();
        var val = {
          order_num: str,
        };
        if (str != "" || str != null) {
          var url = "https://saraban.demo-cv.com/order/changeThaiNumberFormat";
          $.post(url, val, function (data) {
            $(obj).val(data);
          });
        }
      }

      function changeThaiNumber(num) {
        var array = {
          1: "๑",
          2: "๒",
          3: "๓",
          4: "๔",
          5: "๕",
          6: "๖",
          7: "๗",
          8: "๘",
          9: "๙",
          0: "๐",
        };
        var str = num.toString();
        for (var val in array) {
          str = str.split(val).join(array[val]);
        }
        return str;
      }

      function show_export(data) {
        var div = "#show_export " + data;
        $("#show_export" + data).toggle();
        //$('.show_export').hide();
        $("#start_export_date" + data).val("");
        $("#end_export_date" + data).val("");
        $("#export_operate" + data).val("");
      }

      function clear_input_export(data) {
        $("#export_excel" + data).submit();
        $("#show_export" + data).toggle();
      }

      function toThaiString(obj) {
        var str = $(obj).val();
        //str = str.replace(/[^0-9\.๐-๙ก-ฮ()]/g, '');

        console.log("str : " + str);
        $(obj).val(str);

        var val = {
          order_num: str,
        };

        if (str != "" || str != null) {
          var url = "https://saraban.demo-cv.com/order/changeToThaiOrderShow";
          console.log(url);
          $.post(url, val, function (data) {
            console.log(data);
            $(obj).val(data);
          });
        }
      }

      function toThaiStringNoPreg(obj) {
        var str = $(obj).val();

        var val = {
          order_num: str,
        };
        if (str != "" || str != null) {
          var url = "https://saraban.demo-cv.com/order/changeToThaiOrderShow";
          console.log(url);
          $.post(url, val, function (data) {
            console.log(data);
            $(obj).val(data);
          });
        }
      }



      function submitAddOrder(uploadKey) {
        //$("#addOrder").submit();
        var isvalid = $("#addOrder").valid();
        if (isvalid) {
          $("#loading").show();
          $("#addOrder").submit();
        }
      }

      function submitCreateOrder() {
        //$("#addOrder").submit();
        var isvalid = $("#create_order").valid();
        if (isvalid) {
          $("#loading").show();
          $("#create_order").submit();
        }
      }
    </script>



  </body>
</html>
